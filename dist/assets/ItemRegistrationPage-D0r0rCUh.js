import{w as F,ak as q,_ as L,r as o,x as G,y as O,al as V,z as b,I as t,am as W,an as K,E as j,ah as Q,aj as X,T as Z,j as e,G as R,J as i,L as B,K as g,M as p,O as J}from"./index-C3POMFfo.js";import{E as I}from"./external-link-CYkReMAq.js";import{u}from"./text-field-DVea379b.js";import{m as U,d as H,P as C,f as m,b as Y,T as x,a as ee,c as re,e as T,g as S}from"./tabs-DDQdqzTW.js";import{P as $}from"./plus-5W98KuP3.js";import{L as se}from"./list-Dx_dxbwH.js";import"./index-BCm8NkGy.js";const te=["1","2","3"],ie=["soft","surface","outline"],N={...L,size:{type:"enum",className:"rt-r-size",values:te,default:"2",responsive:!0},variant:{type:"enum",className:"rt-variant",values:ie,default:"soft"},...q,...F},M=o.createContext({}),w=o.forwardRef((r,n)=>{const{size:s=N.size.default}=r,{asChild:l,children:d,className:z,color:c,...h}=G(r,N,O),_=l?V:"div";return o.createElement(_,{"data-accent-color":c,...h,className:b("rt-CalloutRoot",z),ref:n},o.createElement(M.Provider,{value:o.useMemo(()=>({size:s}),[s])},d))});w.displayName="Callout.Root";const f=o.forwardRef(({className:r,...n},s)=>o.createElement("div",{...n,className:b("rt-CalloutIcon",r),ref:s}));f.displayName="Callout.Icon";const v=o.forwardRef(({className:r,...n},s)=>{const{size:l}=o.useContext(M);return o.createElement(t,{as:"p",size:W(l,K),...n,asChild:!1,ref:s,className:b("rt-CalloutText",r)})});v.displayName="Callout.Text";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ae=j("calendar",ne);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],oe=j("circle-alert",le);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],de=j("circle-check-big",ce);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ue=j("info",he);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],xe=j("loader-circle",me),ge=async r=>{try{const n=await fetch("/api/register-type",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),s=await n.json();if(!n.ok)throw new Error(s.message||"등록에 실패했습니다");return s}catch(n){throw n instanceof Error?n:new Error("네트워크 오류가 발생했습니다")}},pe=async()=>[{id:"1",module_address:"0x1234...abcd",type_name:"GameX::Sword",type:"struct Sword { id: ID, name: String, damage: u64 }",url:"https://gamex.example.com",created_at:"2024-12-01T10:00:00Z",game_name:"GameX",total_items:157},{id:"2",module_address:"0x5678...efgh",type_name:"RPGWorld::Armor",type:"struct Armor { id: ID, name: String, defense: u64, durability: u32 }",url:"https://rpgworld.example.com",created_at:"2024-12-02T14:30:00Z",game_name:"RPG World",total_items:89},{id:"3",module_address:"0x9abc...ijkl",type_name:"MagicQuest::Potion",type:"struct Potion { id: ID, effect: String, potency: u8 }",url:"https://magicquest.example.com",created_at:"2024-12-03T09:15:00Z",game_name:"Magic Quest",total_items:234}],je=()=>X({mutationFn:ge,onSuccess:r=>{console.log("Item type registered successfully:",r)},onError:r=>{console.error("Failed to register item type:",r)}}),E=()=>Q({queryKey:["registeredTypes"],queryFn:pe,staleTime:5*60*1e3}),ye=()=>{const r=Z();return{validateOwner:s=>r?r.address!==s?{isValid:!1,error:"소유자 주소가 현재 연결된 지갑과 일치하지 않습니다"}:{isValid:!0,error:null}:{isValid:!1,error:"지갑이 연결되지 않았습니다"},currentAccount:r}},P={module_address:"",type_name:"",type:"",url:"",owner:"",password:""};function we(){var k;const[r,n]=o.useState(P),[s,l]=o.useState(!1),d=je(),{validateOwner:z,currentAccount:c}=ye(),h=(a,y)=>{n(D=>({...D,[a]:y}))},_=()=>{c!=null&&c.address&&n(a=>({...a,owner:c.address}))},A=async a=>{a.preventDefault();const y=z(r.owner);if(!y.isValid){alert(y.error);return}d.mutate(r,{onSuccess:()=>{n(P)}})};return e.jsx(R,{style:{maxWidth:"600px",margin:"0 auto"},children:e.jsxs(i,{direction:"column",gap:"4",children:[e.jsxs(i,{direction:"column",gap:"2",style:{marginBottom:"1rem"},children:[e.jsx(t,{size:"6",weight:"bold",style:{color:"white"},children:"아이템 타입 등록"}),e.jsx(t,{size:"3",color:"gray",children:"게임 내 아이템을 NFT로 등록하기 위한 구조체 타입을 등록합니다"})]}),e.jsxs(w,{color:"blue",children:[e.jsx(f,{children:e.jsx(ue,{size:16})}),e.jsx(v,{children:"등록된 타입은 게임 개발자가 해당 구조체 기반의 NFT를 생성할 때 사용됩니다. 정확한 모듈 주소와 타입 정보를 입력해주세요."})]}),e.jsx(B,{style:{background:"var(--gray-3)",padding:"1.5rem"},children:e.jsx("form",{onSubmit:A,children:e.jsxs(i,{direction:"column",gap:"4",children:[e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"게임 Dapp 주소 *"}),e.jsx(u,{placeholder:"0x1234...abcd (게임 패키지 주소)",value:r.module_address,onChange:a=>h("module_address",a.target.value),required:!0,style:{width:"100%"}}),e.jsx(t,{size:"2",color:"gray",children:"게임이 배포된 Move 패키지의 주소를 입력하세요"})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"타입 이름 *"}),e.jsx(u,{placeholder:"예: GameX::Sword, RPGWorld::Armor",value:r.type_name,onChange:a=>h("type_name",a.target.value),required:!0,style:{width:"100%"}}),e.jsx(t,{size:"2",color:"gray",children:"모듈명::구조체명 형태로 입력하세요"})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"타입 구조 *"}),e.jsx(u,{placeholder:"struct Sword { id: ID, name: String, damage: u64 }",value:r.type,onChange:a=>h("type",a.target.value),required:!0,style:{width:"100%"}}),e.jsx(t,{size:"2",color:"gray",children:"Move 언어의 구조체 정의를 입력하세요"})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"게임 링크 *"}),e.jsxs(i,{gap:"2",align:"center",children:[e.jsx(u,{placeholder:"https://your-game.com",value:r.url,onChange:a=>h("url",a.target.value),required:!0,style:{flex:1}}),r.url&&e.jsx(g,{type:"button",variant:"ghost",size:"2",onClick:()=>window.open(r.url,"_blank"),children:e.jsx(I,{size:14})})]})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsxs(i,{justify:"between",align:"center",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"실행자 주소 *"}),c&&e.jsx(g,{type:"button",variant:"ghost",size:"1",onClick:_,children:"현재 지갑 주소 사용"})]}),e.jsx(u,{placeholder:"실행할 지갑 주소",value:r.owner,onChange:a=>h("owner",a.target.value),required:!0,style:{width:"100%"}}),c&&e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(p,{color:r.owner===c.address?"green":"yellow",children:r.owner===c.address?"연결된 지갑":"다른 주소"}),r.owner!==c.address&&e.jsx(t,{size:"2",color:"orange",children:"현재 연결된 지갑과 다른 주소입니다"})]})]}),e.jsxs(i,{direction:"column",gap:"2",children:[e.jsx(t,{size:"3",weight:"medium",style:{color:"white"},children:"비밀번호 *"}),e.jsx(u,{type:s?"text":"password",placeholder:"등록 확인용 비밀번호",value:r.password,onChange:a=>h("password",a.target.value),required:!0,style:{width:"100%"}}),e.jsx(g,{type:"button",variant:"ghost",size:"1",onClick:()=>l(!s),children:s?"숨기기":"보이기"})]}),e.jsx(g,{type:"submit",size:"3",style:{marginTop:"1rem"},disabled:d.isPending,children:d.isPending?e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(xe,{size:16,className:"animate-spin"}),"등록 중..."]}):"타입 등록하기"}),d.isSuccess&&e.jsxs(w,{color:"green",children:[e.jsx(f,{children:e.jsx(de,{size:16})}),e.jsx(v,{children:"아이템 타입이 성공적으로 등록되었습니다!"})]}),d.isError&&e.jsxs(w,{color:"red",children:[e.jsx(f,{children:e.jsx(oe,{size:16})}),e.jsxs(v,{children:["등록 실패: ",(k=d.error)==null?void 0:k.message]})]})]})})})]})})}const fe=r=>new Date(r).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric"}),ve=r=>`${r.slice(0,8)}...${r.slice(-6)}`;function ze(){const{data:r,isLoading:n,error:s}=E();return n?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(t,{style:{color:"white"},children:"등록된 타입을 불러오는 중..."})}):s?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(t,{style:{color:"red"},children:"타입 정보를 불러오는데 실패했습니다"})}):!r||r.length===0?e.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:e.jsx(t,{style:{color:"gray"},children:"등록된 아이템 타입이 없습니다"})}):e.jsx("div",{style:{background:"var(--gray-3)",borderRadius:"8px",overflow:"hidden"},children:e.jsxs(U,{children:[e.jsx(H,{children:e.jsxs(C,{children:[e.jsx(m,{children:"게임명"}),e.jsx(m,{children:"타입명"}),e.jsx(m,{children:"모듈 주소"}),e.jsx(m,{children:"아이템 수"}),e.jsx(m,{children:"등록일"}),e.jsx(m,{children:"링크"})]})}),e.jsx(Y,{children:r.map(l=>e.jsxs(C,{children:[e.jsx(x,{children:e.jsxs(i,{direction:"column",gap:"1",children:[e.jsx(t,{size:"3",weight:"bold",style:{color:"white"},children:l.game_name||"Unknown Game"}),e.jsx(t,{size:"2",style:{color:"var(--gray-11)"},children:l.type_name.split("::")[0]})]})}),e.jsx(x,{children:e.jsxs(i,{direction:"column",gap:"1",children:[e.jsx(t,{size:"3",style:{color:"var(--blue-11)"},children:l.type_name.split("::")[1]||l.type_name}),e.jsx(p,{color:"purple",size:"1",children:"Struct"})]})}),e.jsx(x,{children:e.jsx(t,{size:"2",style:{color:"var(--gray-11)",fontFamily:"monospace"},children:ve(l.module_address)})}),e.jsx(x,{children:e.jsxs(p,{color:"green",variant:"soft",children:[l.total_items,"개"]})}),e.jsx(x,{children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(ae,{size:14,color:"gray"}),e.jsx(t,{size:"2",style:{color:"var(--gray-11)"},children:fe(l.created_at)})]})}),e.jsx(x,{children:e.jsx(g,{size:"1",variant:"ghost",onClick:()=>window.open(l.url,"_blank"),children:e.jsx(I,{size:14})})})]},l.id))})]})})}function Ne(){const[r,n]=o.useState("register"),{data:s}=E();return e.jsx(R,{style:{maxWidth:"1400px",margin:"0 auto"},children:e.jsxs(i,{direction:"column",gap:"4",children:[e.jsxs(i,{justify:"between",align:"center",style:{padding:"1rem 0"},children:[e.jsxs(i,{align:"center",gap:"3",children:[e.jsx($,{size:32,style:{color:"var(--blue-11)"}}),e.jsxs(i,{direction:"column",gap:"1",children:[e.jsx(J,{size:"6",style:{color:"white"},children:"아이템 타입 등록"}),e.jsx(t,{size:"3",color:"gray",children:"게임 내 아이템을 NFT로 만들기 위한 구조체 타입을 등록하세요"})]})]}),e.jsxs(p,{color:"blue",variant:"soft",children:["총 ",(s==null?void 0:s.length)||0,"개 타입 등록됨"]})]}),e.jsxs(ee,{value:r,onValueChange:n,children:[e.jsxs(re,{children:[e.jsx(T,{value:"register",children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx($,{size:16}),"새 타입 등록"]})}),e.jsx(T,{value:"list",children:e.jsxs(i,{align:"center",gap:"2",children:[e.jsx(se,{size:16}),"등록된 타입 목록",s&&s.length>0&&e.jsx(p,{color:"blue",size:"1",children:s.length})]})})]}),e.jsx(S,{value:"register",style:{marginTop:"2rem"},children:e.jsx(we,{})}),e.jsx(S,{value:"list",style:{marginTop:"2rem"},children:e.jsxs(i,{direction:"column",gap:"3",children:[e.jsx(t,{size:"4",weight:"bold",style:{color:"white"},children:"등록된 아이템 타입"}),e.jsx(t,{size:"2",color:"gray",children:"현재 플랫폼에 등록된 모든 게임 아이템 타입을 확인할 수 있습니다"}),e.jsx(ze,{})]})})]})]})})}export{Ne as ItemRegistrationPage};
