import{E as L,Q as $,S as T,T as _,r as w,j as e,G as g,I as r,K as o,J as t,L as z,O as F,M as H}from"./index-C3POMFfo.js";import{a as A,b as D,c as E,d as M,e as O}from"./useListings-h6RYeRdS.js";import{H as U}from"./heart-Bd87yWO7.js";import{S as q}from"./shopping-cart-BTtZdRnj.js";import{p as x}from"./box-u8m9NNA-.js";import"./useApi-DnSGaFtl.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],J=L("arrow-left",G);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Q=L("share-2",K);function R(){var j,p,f,k;const{id:l}=$(),h=T(),i=_(),{data:s,isLoading:b}=A(l),{data:n}=D(l),{mutate:v}=E(),{mutate:P}=M(),{mutate:S}=O(),[c,m]=w.useState(!1),[d,y]=w.useState(!1),I=()=>{i!=null&&i.address&&(c?(P({listingId:l,userAddress:i.address}),m(!1)):(v({listingId:l,userAddress:i.address}),m(!0)))},N=async()=>{if(!(!(i!=null&&i.address)||!s)){y(!0);try{const a=`0x${Math.random().toString(16).substr(2,64)}`;S({listingId:l,buyerAddress:i.address,txHash:a}),alert("Purchase successful!"),h("/my-nfts")}catch(a){console.error("Purchase failed:",a),alert("Purchase failed. Please try again.")}finally{y(!1)}}},B=a=>a?`${Number(a)/1e9} SUI`:"Not for sale";if(b)return e.jsx(g,{style:{padding:"2rem",textAlign:"center"},children:e.jsx(r,{style:{color:"white"},children:"Loading..."})});if(!s)return e.jsx(g,{style:{padding:"2rem",textAlign:"center"},children:e.jsx(r,{style:{color:"white"},children:"Listing not found"})});const u=(i==null?void 0:i.address)===s.owner,C=!u&&s.price&&s.status==="active";return e.jsxs(g,{style:{maxWidth:"1200px",margin:"0 auto",padding:"2rem"},children:[e.jsxs(o,{variant:"ghost",onClick:()=>h(-1),style:{marginBottom:"1rem"},children:[e.jsx(J,{size:16}),"Back"]}),e.jsxs(t,{gap:"6",direction:{initial:"column",md:"row"},children:[e.jsx(x,{style:{flex:"1"},children:e.jsx(z,{style:{padding:"0",overflow:"hidden"},children:e.jsx("img",{src:((j=s.metadata)==null?void 0:j.image)||"https://via.placeholder.com/400x400?text=NFT",alt:((p=s.metadata)==null?void 0:p.name)||"NFT",style:{width:"100%",height:"400px",objectFit:"cover"}})})}),e.jsx(x,{style:{flex:"1"},children:e.jsx(z,{style:{padding:"2rem",background:"var(--gray-6)"},children:e.jsxs(t,{direction:"column",gap:"4",children:[e.jsxs(t,{justify:"between",align:"start",children:[e.jsxs(x,{children:[e.jsx(F,{size:"6",style:{color:"white",marginBottom:"0.5rem"},children:((f=s.metadata)==null?void 0:f.name)||"Unknown Item"}),s.type_name&&e.jsx(H,{color:"blue",variant:"soft",children:s.type_name})]}),e.jsxs(t,{gap:"2",children:[i&&e.jsxs(o,{variant:"ghost",size:"3",onClick:I,style:{color:c?"red":"var(--gray-11)"},children:[e.jsx(U,{size:20,fill:c?"red":"none"}),(n==null?void 0:n.likes)||0]}),e.jsx(o,{variant:"ghost",size:"3",children:e.jsx(Q,{size:20})})]})]}),((k=s.metadata)==null?void 0:k.description)&&e.jsx(r,{size:"3",color:"gray",children:s.metadata.description}),e.jsxs(t,{direction:"column",gap:"2",children:[e.jsx(r,{size:"2",color:"gray",children:"Price"}),e.jsx(r,{size:"6",weight:"bold",color:"green",children:B(s.price)})]}),e.jsxs(t,{direction:"column",gap:"2",children:[e.jsx(r,{size:"2",color:"gray",children:"Owner"}),e.jsx(r,{size:"3",style:{fontFamily:"monospace"},children:s.owner})]}),n&&e.jsxs(t,{gap:"4",children:[e.jsxs(t,{direction:"column",align:"center",children:[e.jsx(r,{size:"4",weight:"bold",color:"blue",children:n.likes}),e.jsx(r,{size:"2",color:"gray",children:"Likes"})]}),e.jsxs(t,{direction:"column",align:"center",children:[e.jsx(r,{size:"4",weight:"bold",color:"green",children:n.sales}),e.jsx(r,{size:"2",color:"gray",children:"Sales"})]}),e.jsxs(t,{direction:"column",align:"center",children:[e.jsx(r,{size:"4",weight:"bold",color:"orange",children:n.views}),e.jsx(r,{size:"2",color:"gray",children:"Views"})]})]}),e.jsxs(t,{gap:"3",style:{marginTop:"1rem"},children:[C&&e.jsxs(o,{size:"3",style:{flex:1},onClick:N,disabled:d,children:[e.jsx(q,{size:16}),d?"Processing...":"Buy Now"]}),u&&s.status==="active"&&e.jsx(o,{size:"3",variant:"outline",style:{flex:1},disabled:d,children:"Cancel Listing"}),!i&&e.jsx(r,{size:"2",color:"gray",style:{textAlign:"center",padding:"1rem"},children:"Connect your wallet to interact with this NFT"})]})]})})})]})]})}function se(){return e.jsx(R,{})}export{se as ListingDetailPage};
